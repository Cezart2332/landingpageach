class GDPRCookieManager{constructor(){this.config={cookieName:"acoomh_gdpr_consent",consentVersion:"1.0",cookieExpireDays:365,showBannerDelay:1e3,privacyPolicyUrl:"privacy-policy.html",categories:{necessary:{id:"necessary",name:"Necesare",description:"Aceste cookie-uri sunt esen»õiale pentru func»õionarea site-ului web »ôi nu pot fi dezactivate.",required:!0,cookies:["PHPSESSID","acoomh_session","csrf_token"],cookieDescription:"Informa»õii de sesiune pentru autentificare, protec»õie √Æmpotriva atacurilor »ôi pƒÉstrarea preferin»õelor de navigare pe parcursul vizitei tale."},analytics:{id:"analytics",name:"AnalizƒÉ",description:"Ne ajutƒÉ sƒÉ √Æn»õelegem cum interac»õionezi cu site-ul nostru prin colectarea informa»õiilor √Æn mod anonim.",required:!1,cookies:["_ga","_ga_*","_gid","_gat","gtag"],cookieDescription:"Statistici anonime despre vizitatorii site-ului, paginile vizitate »ôi timpul petrecut pe fiecare paginƒÉ pentru √ÆmbunƒÉtƒÉ»õirea experien»õei utilizatorilor."},marketing:{id:"marketing",name:"Marketing",description:"Utilizate pentru a-»õi afi»ôa reclame relevante »ôi pentru a mƒÉsura eficien»õa campaniilor publicitare.",required:!1,cookies:["_fbp","_fbc","fr","tr","ads_*"],cookieDescription:"UrmƒÉrirea intereselor tale pentru afi»ôarea de reclame personalizate pe AcoomH »ôi pe alte site-uri partenere."},preferences:{id:"preferences",name:"Preferin»õe",description:"Permit site-ului sƒÉ re»õinƒÉ informa»õii care schimbƒÉ modul √Æn care se comportƒÉ sau aratƒÉ.",required:!1,cookies:["theme_preference","language","acoomh_preferences"],cookieDescription:"SetƒÉrile tale personale cum ar fi tema site-ului (modul √Æntunecat/luminos), limba preferatƒÉ »ôi alte preferin»õe de afi»ôare."}}},this.consentData=null,this.isInitialized=!1,this.init=this.init.bind(this),this.showBanner=this.showBanner.bind(this),this.showPreferences=this.showPreferences.bind(this),this.acceptAll=this.acceptAll.bind(this),this.acceptNecessary=this.acceptNecessary.bind(this),this.savePreferences=this.savePreferences.bind(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.init):this.init()}init(){if(!this.isInitialized){console.log("üç™ Initializing GDPR Cookie Manager...");try{this.loadConsent(),this.hasValidConsent()?this.applyConsent():setTimeout(()=>{this.showBanner()},this.config.showBannerDelay),window.acoomhCookies={showPreferences:()=>this.showPreferences(),getConsent:()=>this.getConsent(),hasConsent:e=>this.hasConsent(e),withdrawConsent:()=>this.withdrawConsent()},this.isInitialized=!0,console.log("‚úÖ GDPR Cookie Manager initialized successfully")}catch(e){console.error("‚ùå Error initializing GDPR Cookie Manager:",e)}}}loadConsent(){try{const e=localStorage.getItem(this.config.cookieName);e&&(this.consentData=JSON.parse(e),this.consentData.version!==this.config.consentVersion&&(console.log("üîÑ Consent version outdated, requesting new consent"),this.consentData=null))}catch(e){console.error("Error loading consent data:",e),this.consentData=null}}hasValidConsent(){if(!this.consentData)return!1;const e=new Date(this.consentData.timestamp);return e.setDate(e.getDate()+this.config.cookieExpireDays),new Date<e}showBanner(){this.removeBanner();const e=document.createElement("div");e.id="gdpr-cookie-banner",e.className="gdpr-banner",e.innerHTML='\n      <div class="gdpr-banner-content">\n        <div class="gdpr-banner-text">\n          <div class="gdpr-banner-icon">\n            <i class="fas fa-cookie-bite"></i>\n          </div>\n          <div class="gdpr-banner-message">\n            <h3>RespectƒÉm confiden»õialitatea ta</h3>\n            <p>Folosim cookie-uri pentru a √ÆmbunƒÉtƒÉ»õi experien»õa ta pe site-ul nostru. Po»õi alege ce tipuri de cookie-uri sƒÉ accep»õi.</p>\n          </div>\n        </div>\n        <div class="gdpr-banner-actions">\n          <button class="gdpr-btn gdpr-btn-secondary" onclick="window.acoomhCookies.showPreferences()">\n            <i class="fas fa-cog"></i>\n            PersonalizeazƒÉ\n          </button>\n          <button class="gdpr-btn gdpr-btn-outline" id="gdpr-accept-necessary">\n            <i class="fas fa-shield-alt"></i>\n            Doar necesare\n          </button>\n          <button class="gdpr-btn gdpr-btn-primary" id="gdpr-accept-all">\n            <i class="fas fa-check"></i>\n            Accept toate\n          </button>\n        </div>\n      </div>\n    ',document.body.appendChild(e),document.getElementById("gdpr-accept-all").addEventListener("click",this.acceptAll),document.getElementById("gdpr-accept-necessary").addEventListener("click",this.acceptNecessary),setTimeout(()=>{e.classList.add("gdpr-banner-visible")},100)}showPreferences(){this.removePreferencesModal();const e=document.createElement("div");e.id="gdpr-preferences-modal",e.className="gdpr-modal-overlay";const t=Object.values(this.config.categories).map(e=>{const t=this.consentData?!0===this.consentData.categories[e.id]:e.required;return`\n        <div class="gdpr-category">\n          <div class="gdpr-category-header">\n            <div class="gdpr-category-title">\n              <label class="gdpr-checkbox-wrapper">\n                <input type="checkbox" \n                       id="gdpr-${e.id}" \n                       ${t?"checked":""} \n                       ${e.required?"disabled":""}\n                       data-category="${e.id}">\n                <span class="gdpr-checkbox-custom"></span>\n                <span class="gdpr-category-name">${e.name}</span>\n                ${e.required?'<span class="gdpr-required">(Obligatoriu)</span>':""}\n              </label>\n            </div>\n          </div>\n          <div class="gdpr-category-description">\n            <p>${e.description}</p>\n            <div class="gdpr-cookies-list">\n              <strong>Cookie-uri:</strong> ${e.cookieDescription}\n            </div>\n          </div>\n        </div>\n      `}).join("");e.innerHTML=`\n      <div class="gdpr-modal-content">\n        <div class="gdpr-modal-header">\n          <h2><i class="fas fa-shield-alt"></i> SetƒÉri Cookie-uri</h2>\n          <button class="gdpr-modal-close" id="gdpr-close-preferences">\n            <i class="fas fa-times"></i>\n          </button>\n        </div>\n        \n        <div class="gdpr-modal-body">\n          <div class="gdpr-privacy-info">\n            <p>Alege ce tipuri de cookie-uri sƒÉ permiti. Po»õi schimba aceste setƒÉri oric√¢nd acces√¢nd linkul din subsol.</p>\n            <a href="${this.config.privacyPolicyUrl}" target="_blank" class="gdpr-privacy-link">\n              <i class="fas fa-external-link-alt"></i>\n              Vezi Politica de Confiden»õialitate\n            </a>\n          </div>\n          \n          <div class="gdpr-categories">\n            ${t}\n          </div>\n        </div>\n        \n        <div class="gdpr-modal-footer">\n          <button class="gdpr-btn gdpr-btn-outline" id="gdpr-reject-all">\n            <i class="fas fa-times"></i>\n            Respinge toate\n          </button>\n          <button class="gdpr-btn gdpr-btn-primary" id="gdpr-save-preferences">\n            <i class="fas fa-save"></i>\n            SalveazƒÉ preferin»õele\n          </button>\n        </div>\n      </div>\n    `,document.body.appendChild(e),document.getElementById("gdpr-close-preferences").addEventListener("click",()=>this.removePreferencesModal()),document.getElementById("gdpr-save-preferences").addEventListener("click",this.savePreferences),document.getElementById("gdpr-reject-all").addEventListener("click",this.acceptNecessary),e.addEventListener("click",t=>{t.target===e&&this.removePreferencesModal()}),document.addEventListener("keydown",this.handleEscapeKey),setTimeout(()=>{e.classList.add("gdpr-modal-visible")},100),this.disableWebsiteScrolling(),this.preventBackgroundScroll(),this.setupModalScrolling(e)}disableWebsiteScrolling(){document.body.setAttribute("data-gdpr-modal-open","true"),this.websiteScrollState={mobileEventListenersActive:window.mobileEventListenersActive,desktopEventListenersActive:window.desktopEventListenersActive,isScrolling:window.isScrolling},void 0!==window.isScrolling&&(window.isScrolling=!0),window.desktopWheelHandler&&(window.removeEventListener("wheel",window.desktopWheelHandler),document.removeEventListener("wheel",window.desktopWheelHandler)),window.touchStartHandler&&document.removeEventListener("touchstart",window.touchStartHandler),window.touchEndHandler&&document.removeEventListener("touchend",window.touchEndHandler),window.touchMoveHandler&&document.removeEventListener("touchmove",window.touchMoveHandler),window.wheelHandler&&document.removeEventListener("wheel",window.wheelHandler)}preventBackgroundScroll(){this.scrollPosition=window.pageYOffset||document.documentElement.scrollTop,document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${this.scrollPosition}px`,document.body.style.width="100%",document.body.classList.add("gdpr-modal-open"),document.documentElement.classList.add("gdpr-modal-open")}setupModalScrolling(e){const t=e.querySelector(".gdpr-modal-body"),n=e.querySelector(".gdpr-modal-content");if(!t||!n)return;const modalWheelHandler=e=>{e.stopPropagation(),e.stopImmediatePropagation();const n=e.deltaY,o=t.scrollTop,i=t.scrollHeight-t.clientHeight;(o<=0&&n<0||o>=i&&n>0)&&e.preventDefault()},modalTouchStartHandler=e=>{e.stopPropagation(),this.modalTouchStartY=e.touches[0].clientY,this.modalStartScrollTop=t.scrollTop},modalTouchMoveHandler=e=>{if(e.stopPropagation(),e.stopImmediatePropagation(),!this.modalTouchStartY)return;const n=e.touches[0].clientY,o=this.modalTouchStartY-n,i=t.scrollTop,s=t.scrollHeight-t.clientHeight;(i<=0&&o<0||i>=s&&o>0)&&e.preventDefault()},modalTouchEndHandler=e=>{e.stopPropagation(),this.modalTouchStartY=null,this.modalStartScrollTop=null};t.addEventListener("wheel",modalWheelHandler,{passive:!1}),t.addEventListener("touchstart",modalTouchStartHandler,{passive:!0}),t.addEventListener("touchmove",modalTouchMoveHandler,{passive:!1}),t.addEventListener("touchend",modalTouchEndHandler,{passive:!0}),this.modalScrollHandlers={wheel:modalWheelHandler,touchstart:modalTouchStartHandler,touchmove:modalTouchMoveHandler,touchend:modalTouchEndHandler,element:t};const blockAllEvents=t=>{if(t.target===e)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),!1};["wheel","touchmove","scroll","mousewheel","DOMMouseScroll"].forEach(t=>{e.addEventListener(t,blockAllEvents,{passive:!1,capture:!0})})}acceptAll(){const e={version:this.config.consentVersion,timestamp:(new Date).toISOString(),categories:{}};Object.keys(this.config.categories).forEach(t=>{e.categories[t]=!0}),this.saveConsent(e),this.removeBanner(),this.removePreferencesModal()}acceptNecessary(){const e={version:this.config.consentVersion,timestamp:(new Date).toISOString(),categories:{}};Object.values(this.config.categories).forEach(t=>{e.categories[t.id]=t.required}),this.saveConsent(e),this.removeBanner(),this.removePreferencesModal()}savePreferences(){const e={version:this.config.consentVersion,timestamp:(new Date).toISOString(),categories:{}};Object.keys(this.config.categories).forEach(t=>{const n=document.getElementById(`gdpr-${t}`);e.categories[t]=!!n&&n.checked}),this.saveConsent(e),this.removePreferencesModal(),this.removeBanner()}saveConsent(e){try{this.consentData=e,localStorage.setItem(this.config.cookieName,JSON.stringify(e)),this.applyConsent(),document.dispatchEvent(new CustomEvent("gdprConsentChanged",{detail:{consent:this.consentData}})),console.log("‚úÖ GDPR consent saved:",e)}catch(e){console.error("‚ùå Error saving consent:",e)}}applyConsent(){this.consentData&&(this.cleanupCookies(),this.loadConsentedScripts(),console.log("üç™ Applied consent settings:",this.consentData.categories))}cleanupCookies(){Object.values(this.config.categories).forEach(e=>{this.hasConsent(e.id)||e.cookies.forEach(e=>{this.deleteCookie(e)})})}deleteCookie(e){document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`,document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=${window.location.hostname};`,document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${window.location.hostname};`}loadConsentedScripts(){this.hasConsent("analytics")&&this.loadGoogleAnalytics(),this.hasConsent("marketing")&&this.loadMarketingScripts()}loadGoogleAnalytics(){window.gtag}loadMarketingScripts(){}hasConsent(e){return!!this.consentData&&!0===this.consentData.categories[e]}getConsent(){return this.consentData}withdrawConsent(){localStorage.removeItem(this.config.cookieName),this.consentData=null,this.cleanupCookies(),this.showBanner()}removeBanner(){const e=document.getElementById("gdpr-cookie-banner");e&&(e.classList.remove("gdpr-banner-visible"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}removePreferencesModal(){const e=document.getElementById("gdpr-preferences-modal");e&&(e.classList.remove("gdpr-modal-visible"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300)),this.restoreBackgroundScroll(),document.removeEventListener("keydown",this.handleEscapeKey)}restoreBackgroundScroll(){document.body.classList.remove("gdpr-modal-open"),document.documentElement.classList.remove("gdpr-modal-open"),document.body.removeAttribute("data-gdpr-modal-open"),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",void 0!==this.scrollPosition&&(window.scrollTo(0,this.scrollPosition),this.scrollPosition=void 0),this.restoreWebsiteScrolling(),this.cleanupModalScrollHandlers()}restoreWebsiteScrolling(){this.websiteScrollState&&void 0!==window.isScrolling&&(window.isScrolling=this.websiteScrollState.isScrolling||!1),"function"==typeof window.updateScrollMode&&setTimeout(()=>{window.updateScrollMode()},100),this.websiteScrollState=null}cleanupModalScrollHandlers(){if(this.modalScrollHandlers){const{element:e,wheel:t,touchstart:n,touchmove:o,touchend:i}=this.modalScrollHandlers;e&&(e.removeEventListener("wheel",t),e.removeEventListener("touchstart",n),e.removeEventListener("touchmove",o),e.removeEventListener("touchend",i)),this.modalScrollHandlers=null}this.modalTouchStartY=null,this.modalStartScrollTop=null}handleEscapeKey=e=>{"Escape"===e.key&&this.removePreferencesModal()}}window.hasGDPRConsent=function(e){return window.acoomhCookies&&window.acoomhCookies.hasConsent(e)},new GDPRCookieManager;