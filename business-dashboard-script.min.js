document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("pendingRoot"),t=document.getElementById("activeRoot"),n=document.querySelectorAll("[data-company-name]"),o=document.getElementById("statLocations"),a=document.getElementById("statEvents");function setCompanyName(e){n.forEach(t=>t.textContent=e||"Business")}document.querySelectorAll('[data-nav="locations"]').forEach(e=>e.addEventListener("click",()=>{window.location.href="business-locations.html"})),document.querySelectorAll('[data-nav="events"]').forEach(e=>e.addEventListener("click",()=>{window.location.href="business-events.html"})),document.querySelectorAll("[data-logout]").forEach(e=>e.addEventListener("click",async()=>{if(confirm("Sigur te deconectezi?")){try{window.SecureApiService&&await window.SecureApiService.logout()}catch{}window.location.href="business-auth.html"}})),(async()=>{const n=await async function(){try{const n=await(window.SecureApiService?window.SecureApiService.getProfile():Promise.resolve({success:!1}));if(n.success&&n.data){const o=n.data.company||n.data;setCompanyName(o.name||o.CompanyName||"Business");const a=!0===o.isActive||1===o.isActive||"1"===String(o.isActive);return e.style.display=a?"none":"block",t.style.display=a?"block":"none",o}return e.style.display="none",t.style.display="block",setCompanyName("Business"),null}catch(n){return e.style.display="none",t.style.display="block",setCompanyName("Business"),null}}();await async function(e){try{if(!e||!e.id)return o.textContent="-",void(a.textContent="-");const t=await window.SecureApiService.get(`/companies/${e.id}/locations`),n=t&&t.success?t.data:[],c=Array.isArray(n)?n.length:Number(n?.count)||0;o.textContent=String(c);const i=new FormData;i.append("id",String(e.id));const s=await window.SecureApiService.post("/companyevents",i),r=s&&s.success?s.data:[],d=Array.isArray(r)?r.length:Number(r?.count)||0;a.textContent=String(d)}catch(e){o.textContent="-",a.textContent="-"}}(n)})()});