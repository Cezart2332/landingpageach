document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add("loading");const e=["localhost","127.0.0.1"].includes(window.location.hostname)?"/api":"https://api.acoomh.ro";let t=[],n=[],a=[],i="all",o="",s="all",r=null,d=[];const l={statsRow:document.getElementById("statsRow"),filterTabs:document.getElementById("filterTabs"),searchInput:document.getElementById("searchInput"),locationFilter:document.getElementById("locationFilter"),eventsGrid:document.getElementById("eventsGrid"),loadingState:document.getElementById("loadingState"),errorState:document.getElementById("errorState"),emptyState:document.getElementById("emptyState"),eventModal:document.getElementById("eventModal"),eventForm:document.getElementById("eventForm"),modalTitle:document.getElementById("modalTitle"),deleteModal:document.getElementById("deleteModal"),deleteEventName:document.getElementById("deleteEventName"),eventName:document.getElementById("eventName"),eventDescription:document.getElementById("eventDescription"),eventDate:document.getElementById("eventDate"),eventTime:document.getElementById("eventTime"),eventEndTime:document.getElementById("eventEndTime"),eventAddress:document.getElementById("eventAddress"),eventCity:document.getElementById("eventCity"),isActive:document.getElementById("isActive"),eventImage:document.getElementById("eventImage"),imageUploadArea:document.getElementById("imageUploadArea"),imagePreview:document.getElementById("imagePreview"),previewImg:document.getElementById("previewImg"),removeImage:document.getElementById("removeImage")};function unwrapList(e){return e?Array.isArray(e)?e:Array.isArray(e?.data)?e.data:Array.isArray(e?.items)?e.items:Array.isArray(e?.events)?e.events:[]:[]}async function getActiveCompanyId(){try{if(window.SecureApiService){const e=await window.SecureApiService.getProfile(),t=e&&e.success?e.data:e,n=t?.company||t,a=n?.id||n?.Id;if(a)return Number(a)}}catch(e){}try{const e=sessionStorage.getItem("company");if(e){const t=JSON.parse(e);if(t?.id||t?.Id)return Number(t.id||t.Id)}const t=sessionStorage.getItem("user");if(t){const e=JSON.parse(t);if(e?.id||e?.Id)return Number(e.id||e.Id)}}catch(e){console.warn("Failed to read company/user from storage:",e)}return null}async function loadBusinessEvents(){l.loadingState.style.display="flex",l.errorState.style.display="none",l.emptyState.style.display="none",l.eventsGrid.style.display="none";try{const a=await getActiveCompanyId();if(a&&window.SecureApiService){const e=new FormData;e.append("id",String(a)),e.append("companyId",String(a));const i=await window.SecureApiService.post("/companyevents",e);let o=i&&i.success?i.data:i;if(o=unwrapList(o),Array.isArray(o)&&0!==o.length)t=o.map(normalizeEvent),n=[...t];else{const e=await window.SecureApiService.get("/events");let i=e&&e.success?e.data:e;i=unwrapList(i);const o=i.filter(e=>Number(e.companyId||e.CompanyId||e.company?.id)===Number(a));t=o.map(normalizeEvent),n=[...t]}return updateStatistics(),displayEvents(),hideLoadingState(),void console.log("✅ Loaded business events:",n.length)}const i=await fetch(`${e}/events`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.json(),s=o.data||o||[];if(!Array.isArray(s))throw new Error("API response is not a valid events array");t=s.map(normalizeEvent),n=[...t],updateStatistics(),displayEvents(),hideLoadingState()}catch(e){console.error("Error loading business events:",e),t=Array.isArray(t)?t:[],n=t,displayEvents(),hideLoadingState()}}function hideLoadingState(){l.loadingState.style.display="none"}function displayEvents(){const e=getFilteredEvents();if(0===e.length)return l.loadingState.style.display="none",l.errorState.style.display="none",l.emptyState.style.display="flex",void(l.eventsGrid.style.display="none");l.loadingState.style.display="none",l.errorState.style.display="none",l.emptyState.style.display="none",l.eventsGrid.style.display="grid",l.eventsGrid.innerHTML="",e.forEach(e=>{const t=function(e){const t=document.createElement("div");t.className="event-card",t.setAttribute("data-event-id",e.id);const n=(s=e.status,{upcoming:"status-upcoming",active:"status-active",past:"status-past",draft:"status-draft"}[s]||"status-upcoming"),a=function(e){return{upcoming:"Viitor",active:"Activ",past:"Trecut",draft:"Draft"}[e]||"Viitor"}(e.status),i=function(e,t){try{const n=new Date(e+"T"+t),a={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return n.toLocaleDateString("ro-RO",a)}catch(n){return`${e} la ${t}`}}(e.eventDate,e.eventTime),o=e.tags||[];var s;return t.innerHTML=`\n      <div class="event-image">\n        <img src="${e.imageUrl||function(e){return`https://picsum.photos/seed/${e||"event"}/400/300`}(e.category)}" alt="${e.name}" loading="lazy" />\n        <div class="event-status-badge ${n}">${a}</div>\n      </div>\n      <div class="event-content">\n        <div class="event-header">\n          <h3 class="event-name">${e.name}</h3>\n          <div class="event-location">\n            <i class="fas fa-location-dot"></i>\n            <span>${e.locationName||"Locație necunoscută"}</span>\n          </div>\n          <div class="event-date">\n            <i class="fas fa-calendar"></i>\n            <span>${i}</span>\n          </div>\n        </div>\n        \n        ${o.length>0?`\n          <div class="event-tags">\n            ${o.slice(0,3).map(e=>`<span class="event-tag">${e}</span>`).join("")}\n            ${o.length>3?`<span class="event-tag">+${o.length-3}</span>`:""}\n          </div>\n        `:""}\n        \n        <div class="event-stats">\n          <div class="event-stat">\n            <i class="fas fa-users"></i>\n            <span>${e.capacity||"N/A"} max</span>\n          </div>\n          <div class="event-stat">\n            <i class="fas fa-ticket-alt"></i>\n            <span>${e.ticketsSold||0} vândute</span>\n          </div>\n          <div class="event-stat">\n            <i class="fas fa-euro-sign"></i>\n            <span>${e.isPaid?e.ticketPrice+" RON":"Gratuit"}</span>\n          </div>\n        </div>\n        \n        <div class="event-actions">\n          <button class="btn-view" onclick="viewEventDetails('${e.id}')">\n            <i class="fas fa-eye"></i> Vezi\n          </button>\n          <button class="btn-icon edit" onclick="editEvent('${e.id}')" title="Editează">\n            <i class="fas fa-pen"></i>\n          </button>\n          <button class="btn-icon delete" onclick="confirmDeleteEvent('${e.id}')" title="Șterge">\n            <i class="fas fa-trash"></i>\n          </button>\n        </div>\n      </div>\n    `,t}(e);l.eventsGrid.appendChild(t)})}function normalizeEvent(e){if(!e||"object"!=typeof e)return{};const t=e.id||e.Id||e.eventId||e.EventId||e._id||String(Math.random()).slice(2),n=e.name||e.Name||e.title||"Eveniment",a=e.description||e.Description||"",i=(e.category||e.Category||"altele").toString().toLowerCase(),o=e.locationId||e.LocationId||e.location?.id||e.Location?.Id||null,s=e.locationName||e.LocationName||e.location?.name||e.Location?.Name||e.Location||"Locație necunoscută",r=e.eventDate||e.EventDate||e.date||e.Date||"",d=e.eventTime||e.EventTime||e.time||e.Time||"",l="string"==typeof r&&r.includes("-")?r:r?new Date(r).toISOString().slice(0,10):"",c="string"==typeof d&&d.includes(":")?d:d?String(d).padStart(4,"0").replace(/(\d{2})(\d{2})/,"$1:$2"):"",u=e.duration||e.Duration||"",m=e.capacity||e.Capacity||"",v=!!(e.isPaid||e.IsPaid||e.hasPaidTickets||e.HasPaidTickets),p=e.ticketPrice||e.Price||e.price||0,g=e.earlyBirdPrice||e.EarlyBirdPrice||null,y=e.earlyBirdDeadline||e.EarlyBirdDeadline||null;let f=[];Array.isArray(e.tags)?f=e.tags.map(e=>String(e)):"string"==typeof e.tags&&(f=e.tags.split(",").map(e=>e.trim()).filter(Boolean));const E=e.specialInstructions||"",h=!(!e.isPromoted&&!e.IsPromoted),w=e.ticketsSold||e.TicketsSold||0,S=e.imageUrl||e.photoUrl||e.PhotoUrl||e.photo||e.Photo||"",I=e.status||function(e,t){const n=new Date,a=new Date(e+"T"+t);return a>n?"upcoming":a.toDateString()===n.toDateString()?"active":"past"}(l||"",c||"");return{id:t,name:n,description:a,category:i,locationId:o,locationName:s,eventDate:l,eventTime:c,duration:u,capacity:m,isPaid:v,ticketPrice:p,earlyBirdPrice:g,earlyBirdDeadline:y,tags:f,specialInstructions:E,isPromoted:h,ticketsSold:w,imageUrl:S,status:I}}function getFilteredEvents(){let e=[...t];if("all"!==i&&(e=e.filter(e=>e.status===i)),"all"!==s&&(e=e.filter(e=>e.locationId.toString()===s)),o){const t=o.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)||e.tags&&e.tags.some(e=>e.toLowerCase().includes(t)))}return e}function updateStatistics(){const e={total:t.length,active:t.filter(e=>"active"===e.status).length,upcoming:t.filter(e=>"upcoming"===e.status).length,ticketsSold:t.reduce((e,t)=>e+(t.ticketsSold||0),0)};document.getElementById("totalEvents").textContent=e.total,document.getElementById("activeEvents").textContent=e.active,document.getElementById("upcomingEvents").textContent=e.upcoming,document.getElementById("ticketsSold").textContent=e.ticketsSold}function populateLocationFilter(){const e=l.locationFilter;e.innerHTML='<option value="all">Toate locațiile</option>',a.forEach(t=>{const n=document.createElement("option");n.value=t.id,n.textContent=t.name||t.Name||`Locația ${t.id}`,e.appendChild(n)})}function openEventModal(e=null){r=e,e?(l.modalTitle.textContent="Editează Eveniment",function(e){l.eventName.value=e.title||e.name||"",l.eventDescription.value=e.description||"",l.eventDate.value=e.eventDate||e.date||"",l.eventTime.value=(e.startTime||e.time||"").toString().slice(0,5),l.eventEndTime.value=(e.endTime||"").toString().slice(0,5),l.eventAddress.value=e.address||"",l.eventCity.value=e.city||"",l.isActive.checked=!(!e.isActive&&"active"!==e.status),(e.imageUrl||e.photoUrl)&&(l.previewImg.src=e.imageUrl||e.photoUrl,l.imageUploadArea.style.display="none",l.imagePreview.style.display="block")}(e)):(l.modalTitle.textContent="Adaugă Eveniment",resetEventForm()),l.eventModal.style.display="flex",document.body.style.overflow="hidden"}function closeEventModal(){l.eventModal.style.display="none",document.body.style.overflow="auto",resetEventForm(),r=null}function resetEventForm(){l.eventForm.reset(),l.imageUploadArea.style.display="block",l.imagePreview.style.display="none",l.previewImg.src="";const e=(new Date).toISOString().split("T")[0];l.eventDate.min=e}function applyFilters(){n=getFilteredEvents(),displayEvents()}function handleLocationTypeChange(){l.ownLocationRadio.checked?(l.ownLocationSelector.style.display="block",l.otherLocationInput.style.display="none",l.customLocationName.value="",l.customLocationAddress.value="",l.customLocationName.required=!1,l.customLocationAddress.required=!1):(l.ownLocationSelector.style.display="none",l.otherLocationInput.style.display="block",l.customLocationName.required=!0,l.customLocationAddress.required=!0),document.getElementById("eventLocationError").style.display="none",document.getElementById("customLocationError").style.display="none"}function handleTagsInput(e){const t=e.target.value;if(t.includes(",")){t.split(",").map(e=>e.trim()).filter(Boolean).forEach(e=>{e&&!d.includes(e)&&d.length<10&&d.push(e)}),e.target.value="",updateTagsPreview()}}function handleTagsKeydown(e){if("Enter"===e.key){e.preventDefault();const t=e.target.value.trim();t&&!d.includes(t)&&d.length<10&&(d.push(t),e.target.value="",updateTagsPreview())}"Backspace"===e.key&&!e.target.value&&d.length>0&&(d.pop(),updateTagsPreview())}function updateTagsPreview(){l.tagsPreview.innerHTML=d.map(e=>`\n      <span class="tag-chip">\n        ${e}\n        <button type="button" onclick="removeTag('${e}')">×</button>\n      </span>\n    `).join("")}function handleImageUpload(e){const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{var t;t=e.target.result,l.previewImg.src=t,l.imageUploadArea.style.display="none",l.imagePreview.style.display="block"},e.readAsDataURL(t)}}function hideImagePreview(){l.imageUploadArea.style.display="block",l.imagePreview.style.display="none",l.eventImage.value=""}async function handleEventFormSubmit(n){if(n.preventDefault(),console.log("Form submission started..."),!function(){clearFormErrors();const e=[];return l.eventName.value.trim()||(showFieldError("eventNameError","Titlul este obligatoriu"),e.push("name")),l.eventDescription.value.trim()||(showFieldError("eventDescriptionError","Descrierea este obligatorie"),e.push("desc")),l.eventDate.value||(showFieldError("eventDateError","Data este obligatorie"),e.push("date")),l.eventTime.value||(showFieldError("eventTimeError","Ora de început este obligatorie"),e.push("stime")),l.eventEndTime.value||(showFieldError("eventEndTimeError","Ora de sfârșit este obligatorie"),e.push("etime")),l.eventAddress.value.trim()||(showFieldError("eventAddressError","Adresa este obligatorie"),e.push("addr")),0===e.length}())return void console.log("Form validation failed");const a=document.getElementById("saveEventBtn"),i=a.innerHTML;try{a.disabled=!0,a.innerHTML='<i class="fas fa-spinner fa-spin"></i> Salvare...';const n=await async function(){try{if(window.SecureApiService){const e=await window.SecureApiService.getProfile(),t=e&&e.success?e.data:e,n=t?.company||t;return n?.id||n?.Id||null}}catch{}try{const e=sessionStorage.getItem("company");if(e){const t=JSON.parse(e);return t?.id||t?.Id||null}}catch{}return null}(),i={title:l.eventName.value.trim(),description:l.eventDescription.value.trim(),eventDate:l.eventDate.value,startTime:5===l.eventTime.value.length?l.eventTime.value+":00":l.eventTime.value,endTime:5===l.eventEndTime.value.length?l.eventEndTime.value+":00":l.eventEndTime.value,address:l.eventAddress.value.trim(),city:l.eventCity.value.trim(),isActive:!!l.isActive.checked,companyId:n,imageFile:l.eventImage.files[0]||null};let o;if(r){console.log("Updating existing event:",r.id),o=await async function(t,n){try{const a=new FormData;if(a.append("title",n.title),a.append("description",n.description),a.append("eventDate",n.eventDate),a.append("startTime",n.startTime),a.append("endTime",n.endTime),a.append("address",n.address),n.city&&a.append("city",n.city),"boolean"==typeof n.isActive&&a.append("isActive",n.isActive?"true":"false"),n.imageFile&&a.append("file",n.imageFile),window.SecureApiService){const e=await window.SecureApiService.put(`/events/${t}`,a);if(!e||!e.success)throw new Error(e?.error||"Failed to update event");const n=e.data||null;return console.log("✅ Successfully updated event:",n),n}const i=await fetch(`${e}/events/${t}`,{method:"PUT",body:a});if(!i.ok){const e=await i.text();throw new Error(e||"Failed to update event")}const o=await i.json();return console.log("✅ Successfully updated event (fallback):",o),o}catch(e){throw console.error("Error updating event:",e),e}}(r.id,i);const n=t.findIndex(e=>e.id===r.id);-1!==n&&(t[n]={...t[n],...i,...o}),showNotification("Eveniment actualizat cu succes!","success")}else{console.log("Creating new event"),o=await async function(t){try{const n=new FormData;if(n.append("title",t.title),n.append("description",t.description),n.append("eventDate",t.eventDate),n.append("startTime",t.startTime),n.append("endTime",t.endTime),n.append("address",t.address),t.city&&n.append("city",t.city),t.companyId&&n.append("companyId",String(t.companyId)),n.append("isActive",t.isActive?"true":"false"),t.imageFile&&n.append("file",t.imageFile),window.SecureApiService){const e=await window.SecureApiService.post("/events",n);if(!e||!e.success)throw new Error(e?.error||"Failed to create event");const t=e.data||null;return console.log("✅ Successfully created event:",t),t}const a=await fetch(`${e}/events`,{method:"POST",body:n});if(!a.ok){const e=await a.text();throw new Error(e||"Failed to create event")}const i=await a.json();return console.log("✅ Successfully created event (fallback):",i),i}catch(e){throw console.error("Error creating event:",e),e}}(i);const n={...i,...o,id:o.id||Date.now(),ticketsSold:0,locationName:i.address};t.unshift(n),showNotification("Eveniment creat cu succes!","success")}closeEventModal(),updateStatistics(),applyFilters()}catch(e){console.error("Error saving event:",e),showNotification("Eroare la salvarea evenimentului: "+e.message,"error")}finally{a.disabled=!1,a.innerHTML=i}}function closeDeleteModal(){l.deleteModal.style.display="none",document.body.style.overflow="auto",delete l.deleteModal.dataset.eventId}async function handleDeleteEvent(){const n=l.deleteModal.dataset.eventId;if(!n)return;const a=document.getElementById("confirmDeleteBtn"),i=a.innerHTML;try{a.disabled=!0,a.innerHTML='<i class="fas fa-spinner fa-spin"></i> Ștergere...',await async function(t){try{if(window.SecureApiService){const e=await window.SecureApiService.delete(`/events/${t}`);if(!e||!e.success)throw new Error(e?.error||`HTTP ${e?.status}`);return console.log("✅ Successfully deleted event:",t),!0}const n=await fetch(`${e}/events/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return console.log("✅ Successfully deleted event (fallback):",t),!0}catch(e){throw console.error("Error deleting event:",e),e}}(n),t=t.filter(e=>e.id.toString()!==n.toString()),closeDeleteModal(),updateStatistics(),applyFilters(),showNotification("Eveniment șters cu succes!","success")}catch(e){console.error("Error deleting event:",e),showNotification("Eroare la ștergerea evenimentului: "+e.message,"error")}finally{a.disabled=!1,a.innerHTML=i}}function showNotification(e,t="info"){const n=document.createElement("div");if(n.className=`notification ${t}`,n.innerHTML=`\n      <div class="notification-content">\n        <i class="fas ${"success"===t?"fa-check-circle":"error"===t?"fa-exclamation-circle":"fa-info-circle"}"></i>\n        <span>${e}</span>\n      </div>\n    `,!document.querySelector(".notification-styles")){const e=document.createElement("style");e.className="notification-styles",e.textContent="\n        .notification {\n          position: fixed;\n          top: 80px;\n          right: 20px;\n          z-index: 10000;\n          padding: 16px 20px;\n          border-radius: 12px;\n          color: #fff;\n          font-weight: 600;\n          box-shadow: 0 10px 25px rgba(0,0,0,0.3);\n          animation: slideInRight 0.3s ease;\n        }\n        .notification.success { background: var(--success); }\n        .notification.error { background: var(--danger); }\n        .notification.info { background: var(--info); }\n        .notification-content { display: flex; align-items: center; gap: 10px; }\n        @keyframes slideInRight {\n          from { transform: translateX(100%); opacity: 0; }\n          to { transform: translateX(0); opacity: 1; }\n        }\n      ",document.head.appendChild(e)}document.body.appendChild(n),setTimeout(()=>{n.style.animation="slideInRight 0.3s ease reverse",setTimeout(()=>n.remove(),300)},3e3)}function hideLoadingOverlay(){const e=document.getElementById("pageLoadingOverlay")||document.getElementById("immediateLoadingOverlay");e&&(e.classList.add("hidden"),setTimeout(()=>{document.body.classList.add("loaded"),document.body.classList.remove("loading")},300))}window.viewEventDetails=function(e){window.open(`event.html?id=${e}`,"_blank")},window.editEvent=function(e){const n=t.find(t=>t.id.toString()===e.toString());n&&openEventModal(n)},window.confirmDeleteEvent=function(e){!function(e){const n=t.find(t=>t.id.toString()===e.toString());n&&(l.deleteEventName.textContent=n.name,l.deleteModal.style.display="flex",l.deleteModal.dataset.eventId=e,document.body.style.overflow="hidden")}(e)},window.removeTag=function(e){d=d.filter(t=>t!==e),updateTagsPreview()},async function(){try{document.querySelectorAll("[data-logout]").forEach(e=>{e.addEventListener("click",()=>{confirm("Sigur te deconectezi?")&&(window.location.href="business-auth.html")})}),document.getElementById("addEventBtn").addEventListener("click",()=>openEventModal()),document.getElementById("addFirstEventBtn").addEventListener("click",()=>openEventModal()),l.filterTabs.addEventListener("click",e=>{const t=e.target.closest(".filter-btn");t&&(i=t.dataset.filter,l.filterTabs.querySelectorAll(".filter-btn").forEach(e=>{e.classList.toggle("active",e.dataset.filter===i)}),applyFilters())}),l.searchInput.addEventListener("input",e=>{o=e.target.value.trim(),applyFilters()}),l.locationFilter.addEventListener("change",e=>{s=e.target.value,applyFilters()}),document.querySelectorAll("[data-close-modal]").forEach(e=>{e.addEventListener("click",closeEventModal)}),document.querySelectorAll("[data-close-delete]").forEach(e=>{e.addEventListener("click",closeDeleteModal)}),l.eventForm.addEventListener("submit",handleEventFormSubmit),l.eventTags.addEventListener("input",handleTagsInput),l.eventTags.addEventListener("keydown",handleTagsKeydown),l.imageUploadArea.addEventListener("click",()=>l.eventImage.click()),l.eventImage.addEventListener("change",handleImageUpload),l.removeImage.addEventListener("click",hideImagePreview),document.getElementById("confirmDeleteBtn").addEventListener("click",handleDeleteEvent),document.getElementById("retryBtn").addEventListener("click",()=>{loadBusinessEvents()}),l.ownLocationRadio.addEventListener("change",handleLocationTypeChange),l.otherLocationRadio.addEventListener("change",handleLocationTypeChange),await async function(){try{const t=await getActiveCompanyId();if(t&&window.SecureApiService){const e=await window.SecureApiService.get(`/companies/${t}/locations`),n=e&&e.success?e.data:e;return a=Array.isArray(n)?n:[],populateLocationFilter(),void console.log("✅ Loaded company locations:",a.length)}const n=await fetch(`${e}/locations`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(n.ok){const e=await n.json();a=Array.isArray(e)?e:e.data||[],populateLocationFilter(),console.log("✅ Loaded user locations (fallback):",a.length)}else console.warn("Could not load user locations, using fallback mock data"),a=[{id:1,name:"Central Bistro",address:"Str. Centrală Nr. 15, București"},{id:2,name:"Urban Roast",address:"Bd. Magheru Nr. 28, București"},{id:3,name:"Garden Lounge",address:"Str. Florilor Nr. 42, București"}],populateLocationFilter()}catch(e){console.error("Error loading user locations:",e),console.warn("Using fallback mock locations for demonstration"),a=[{id:1,name:"Central Bistro",address:"Str. Centrală Nr. 15, București"},{id:2,name:"Urban Roast",address:"Bd. Magheru Nr. 28, București"},{id:3,name:"Garden Lounge",address:"Str. Florilor Nr. 42, București"}],populateLocationFilter()}}(),await loadBusinessEvents(),updateStatistics(),hideLoadingOverlay()}catch(e){console.error("Error initializing business events page:",e),t="Nu s-au putut încărca datele. Încearcă din nou.",l.loadingState.style.display="none",l.errorState.style.display="flex",l.emptyState.style.display="none",l.eventsGrid.style.display="none",document.getElementById("errorMessage").textContent=t,hideLoadingOverlay()}var t}()});